<section class="py-5">
  <div class="container py-5">
    <h2 class="mb-4">Your Cart</h2>
    <div id="cart-items" class="row">
      <!-- Cart items will be dynamically inserted here -->
    </div>
    <div class="text-end mt-4">
      <h4>Total: <span id="total-price">Rp 0</span></h4>
      <a href="/checkout" class="btn btn-success btn-lg">Checkout</a>
    </div>
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const cart = JSON.parse(localStorage.getItem("cart")) || [];
    const cartItemsContainer = document.getElementById("cart-items");
    const totalPriceElement = document.getElementById("total-price");

    let totalPrice = 0;

    // Tampilkan item cart
    cart.forEach((item) => {
      const itemTotal = item.price * item.quantity;
      totalPrice += itemTotal;

      const itemHtml = `
            <div class="col-md-4 mb-4">
              <div class="card">
                <img src="${item.image}" class="card-img-top" alt="${
        item.name
      }" style="height: 200px; object-fit: cover;">
                <div class="card-body">
                  <h5 class="card-title">${item.name}</h5>
                  <p class="card-text">${new Intl.NumberFormat("id-ID", {
                    style: "currency",
                    currency: "IDR",
                  }).format(item.price)}</p>
                  <p class="card-text">Quantity: ${item.quantity}</p>
                  <button class="btn btn-danger remove-from-cart" data-product-id="${
                    item.id
                  }">Remove</button>
                </div>
              </div>
            </div>
          `;

      cartItemsContainer.innerHTML += itemHtml;
    });

    // Tampilkan total harga
    totalPriceElement.textContent = new Intl.NumberFormat("id-ID", {
      style: "currency",
      currency: "IDR",
    }).format(totalPrice);

    // Tambahkan event listener untuk tombol "Remove"
    const removeButtons = document.querySelectorAll(".remove-from-cart");
    removeButtons.forEach((button) => {
      button.addEventListener("click", function () {
        const productId = button.getAttribute("data-product-id");

        // Hapus produk dari cart
        const updatedCart = cart.filter((item) => item.id !== productId);

        // Simpan cart yang sudah diupdate ke localStorage
        localStorage.setItem("cart", JSON.stringify(updatedCart));

        // Reload halaman untuk menampilkan cart yang sudah diupdate
        location.reload();
      });
    });
  });
</script>
